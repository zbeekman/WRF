!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.6 (r4756) - 12 Feb 2013 10:43
!
!  Differentiation of mechanism_driver in forward (tangent) mode (with options r8 noISIZE):
!   variations   of useful results: chem
!   with respect to varying inputs: t_phy rho_phy chem
!   RW status of diff variables: t_phy:in rho_phy:in chem:in-out
SUBROUTINE g_mechanism_driver(id, curr_secs, ktau, dtstep, ktauc, &
&  dtstepc, config_flags, gmt, julday, t_phy, g_t_phy, moist, p8w, t8w, &
&  gd_cldfr, p_phy, chem, g_chem, rho_phy, g_rho_phy, dz8w, dx, g, z, &
&  z_at_w, xlat, xlong, vdrog3, vcsulf_old, vcso2_old, vch2o2_old, ttday&
&  , tcosz, ph_macr, ph_o31d, ph_o33p, ph_no2, ph_no3o2, ph_no3o, ph_hno2&
&  , ph_hno3, ph_hno4, ph_h2o2, ph_ch2or, ph_ch2om, ph_ch3cho, &
&  ph_ch3coch3, ph_ch3coc2h5, ph_hcocho, ph_ch3cocho, ph_hcochest, &
&  ph_ch3o2h, ph_ch3coo2h, ph_ch3ono2, ph_hcochob, ph_n2o5, ph_o2, &
&  backg_oh, backg_h2o2, backg_no3, addt, addx, addc, etep, oltp, olip, &
&  cslp, limp, hc5p, hc8p, tolp, xylp, apip, isop, hc3p, ethp, o3p, tco3&
&  , mo2, o1d, olnn, rpho, xo2, ketp, olnd, ids, ide, jds, jde, kds, kde&
&  , ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte)

  USE module_configure
  USE module_state_description
  USE module_data_radm2
  USE module_data_sorgam
  USE g_module_gocart_chem
  IMPLICIT NONE
  INTEGER, INTENT(IN) :: id, julday, ids, ide, jds, jde, kds, kde, ims, &
&  ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte
  INTEGER, INTENT(IN) :: ktau, ktauc
  REAL(kind=8), INTENT(IN) :: curr_secs
  REAL, INTENT(IN) :: dtstep, dtstepc, gmt, dx, g
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_moist), INTENT(IN) :: &
&  moist
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_chem), INTENT(INOUT) ::&
&  chem
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_chem), INTENT(INOUT) ::&
&  g_chem
  REAL, DIMENSION(ims:ime, jms:jme), INTENT(IN) :: xlat, xlong, ttday, &
&  tcosz
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: ph_macr, &
&  ph_o31d, ph_o33p, ph_no2, ph_no3o2, ph_no3o, ph_hno2, ph_hno3, ph_hno4&
&  , ph_h2o2, ph_ch2or, ph_ch2om, ph_ch3cho, ph_ch3coch3, ph_ch3coc2h5, &
&  ph_hcocho, ph_ch3cocho, ph_hcochest, ph_ch3o2h, ph_ch3coo2h, &
&  ph_ch3ono2, ph_hcochob, ph_n2o5, ph_o2
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: addt, &
&  addx, addc, etep, oltp, olip, cslp, limp, hc5p, hc8p, tolp, xylp, apip&
&  , isop, hc3p, ethp, o3p, tco3, mo2, o1d, olnn, rpho, xo2, ketp, olnd
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN) :: t_phy, p_phy&
&  , dz8w, z, backg_oh, backg_h2o2, backg_no3, t8w, p8w, z_at_w, rho_phy
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN) :: g_t_phy, &
&  g_rho_phy
  REAL, DIMENSION(ims:ime, kms:kme, jms:jme), OPTIONAL, INTENT(IN) :: &
&  gd_cldfr
  TYPE(GRID_CONFIG_REC_TYPE), INTENT(IN) :: config_flags
  REAL, INTENT(INOUT) :: vdrog3(ims:ime, kms:kme-0, jms:jme, ldrog)
  REAL, INTENT(INOUT) :: vcsulf_old(ims:ime, kms:kme, jms:jme), &
&  vcso2_old(ims:ime, kms:kme, jms:jme), vch2o2_old(ims:ime, kms:kme, jms&
&  :jme)
  INTRINSIC MAX, MIN
  SELECT CASE  (config_flags%chem_opt) 
  CASE (GOCART_SIMPLE, GOCARTRACM_KPP, GOCARTRADM2_KPP, GOCARTRADM2) 
    CALL WRF_DEBUG(15, 'calling g_gocart_chem_driver from g_mechanism_driver')
    CALL G_GOCART_CHEM_DRIVER(curr_secs, dtstepc, config_flags, gmt, &
&                        julday, t_phy, g_t_phy, moist, chem, g_chem, &
&                        rho_phy, g_rho_phy, dz8w, p8w, backg_oh, &
&                        backg_h2o2, backg_no3, gd_cldfr, dx, g, xlat, &
&                        xlong, ttday, tcosz, ids, ide, jds, jde, kds, &
&                        kde, ims, ime, jms, jme, kms, kme, its, ite, jts&
&                        , jte, kts, kte)
       vcsulf_old(its:ite,kts:kte,jts:jte) = &
            max(chem(its:ite,kts:kte,jts:jte,p_sulf),epsilc)
       vcso2_old(its:ite,kts:kte,jts:jte) = &
            max(chem(its:ite,kts:kte,jts:jte,p_so2),epsilc)
       vch2o2_old(its:ite,kts:kte,jts:jte) = &
            max(chem(its:ite,kts:kte,jts:jte,p_h2o2),epsilc)
  END SELECT
END SUBROUTINE g_mechanism_driver
